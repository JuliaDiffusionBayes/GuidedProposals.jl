<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple observations · GuidedProposals.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GuidedProposals.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/overview/">Get started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">User manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guid_prop/">Guided proposals</a></li><li class="is-active"><a class="tocitem" href>Multiple observations</a><ul class="internal"><li><a class="tocitem" href="#Simpler-syntax-1"><span>Simpler syntax</span></a></li></ul></li><li><a class="tocitem" href="../bffg/">BFFG algorithm</a></li><li><a class="tocitem" href="../convenience/">Convenience functions</a></li><li><a class="tocitem" href="../ode_type/">ODE systems</a></li><li><a class="tocitem" href="../additional_options/">Additional options</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to...</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how_to_guides/sample_bridges/">Sample diffusion bridges</a></li><li><a class="tocitem" href="../../how_to_guides/first_passage_time/">Sample diffusions in first-passage time setting</a></li><li><a class="tocitem" href="../../how_to_guides/smoothing/">Do smoothing</a></li><li><a class="tocitem" href="../../how_to_guides/parameter_inference/">Do parameter inference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/smoothing/">Smoothing/Imputation</a></li><li><a class="tocitem" href="../../tutorials/parameter_inference/">Parameter inference</a></li></ul></li><li><a class="tocitem" href="../../module_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User manual</a></li><li class="is-active"><a href>Multiple observations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple observations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDiffusionBayes/GuidedProposals.jl/blob/master/docs/src/manual/multiple_obs.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Guided-proposals-with-multiple-observations-1"><a class="docs-heading-anchor" href="#Guided-proposals-with-multiple-observations-1">Guided proposals with multiple observations</a><a class="docs-heading-anchor-permalink" href="#Guided-proposals-with-multiple-observations-1" title="Permalink"></a></h1><p>In practice, we want to sample from some target diffusion law</p><div>\[\dd X_t = b(t,X_t)\dd t + \sigma(t,X_t) \dd W_t,\quad t\in[0,T],\quad X_0\sim p_0,\]</div><p>conditionally on multiple, partial observations of <span>$X$</span>:</p><div>\[V_{t_i}:=\left\{ L_iX_{t_i}+\eta_i;i=1,\dots,N \right\},\quad L_i\in\RR^{m_i\times d},\quad \eta_i\sim N(\mu_i,\Sigma_i).\]</div><p>This can be done by stacking together <code>GuidProp</code>, each defined on its own interval <span>$[t_{i-1},t_{i}]$</span> and for its own terminal observation <span>$V_{t_i}$</span>. To properly initialize the guiding term we must defined the sequence of <code>GuidProp</code> starting from the last interval <span>$[t_{N-1},t_{N}]$</span> and proceed moving backwards: <span>$[t_{N-2},t_{N-1}],\dots,[0,t_{1}]$</span>, each time passing a <code>GuidProp</code> from the subsequent interval <span>$[t_{i},t_{i+1}]$</span> to the <code>GuidProp</code> that is being defined on <span>$[t_{i-1},t_{i}]$</span>.</p><p>Let&#39;s look at an example with three observations:</p><pre><code class="language-julia">observs = [
    LinearGsnObs(
        1.0, (@SVector [1.0, 2.0]);
        Σ = SDiagonal(1.0, 1.0)
    ),
    LinearGsnObs(
        2.0, (@SVector [1.5]);
        L = (@SMatrix [1.0 0.0]), Σ = SDiagonal(1.0)
    )
    LinearGsnObs(
        3.0, (@SVector [2.0, 3.0]);
        Σ = SDiagonal(1.0, 1.0)
    )
]</code></pre><p>We should define three <code>GuidProp</code> structs as follows:</p><pre><code class="language-julia">dt = 0.01
tts = [
    0.0:dt:(observs[1].t),
    (observs[1].t):dt:(observs[2].t),
    (observs[2].t):dt:(observs[3].t),
]
P_intv3 = GuidProp(tts[3], P_target, LotkaVolterraAux, observs[3])
P_intv2 = GuidProp(tts[2], P_target, LotkaVolterraAux, observs[2]; next_guid_prop=P_intv3)
P_intv1 = GuidProp(tts[1], P_target, LotkaVolterraAux, observs[1]; next_guid_prop=P_intv2)</code></pre><p>That&#39;s it, now a vector</p><pre><code class="language-julia">P = [P_intv1, P_intv2, P_intv3]</code></pre><p>Defines everything we need to sample guided proposals with multiple conditionings.</p><h2 id="Simpler-syntax-1"><a class="docs-heading-anchor" href="#Simpler-syntax-1">Simpler syntax</a><a class="docs-heading-anchor-permalink" href="#Simpler-syntax-1" title="Permalink"></a></h2><p>Performing steps above is so common that we introduced an additional utility function that does the steps above for the user (and comes with some additional flexibility, more about it in ...). To define multiple guided proposals for multiple observations we first package the observations in a format of a <code>recording</code> from <a href="https://github.com/JuliaDiffusionBayes/DiffObservScheme.jl">DiffObservScheme.jl</a>, so for the example above our <code>recording</code> would become:</p><pre><code class="language-julia">recording = (
    P = P_target,
    obs = observs,
    t0 = 0.0,
    x0_prior = undef # normally, we would provide a prior, however for the steps
    # below it is not needed
)</code></pre><p>Then, to define guided proposals for a given <code>recording</code> we can call</p><pre><code class="language-julia">P = standard_build_guid_prop(LotkaVolterraAux, recording, tts)</code></pre><p>That&#39;s it. <code>P</code> is now equivalent to a vector <code>[P_intv1, P_intv2, P_intv3]</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../guid_prop/">« Guided proposals</a><a class="docs-footer-nextpage" href="../bffg/">BFFG algorithm »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 12 May 2020 18:03">Tuesday 12 May 2020</span>. Using Julia version 1.4.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
